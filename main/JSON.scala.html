<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>JSON.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> dynamicJSON

<span class="keyword">import</span> java.lang.<span class="delimiter">{</span>Boolean =&gt; JBool,Double =&gt; JDouble<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait DynamicJSON extends java.lang.Object with Dynamic with ScalaObject" id="9452">DynamicJSON</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Dynamic">Dynamic</span><span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(name: String)(args: Any*)dynamicJSON.DynamicJSON" id="9531">applyDynamic</a><span class="delimiter">(</span><a title="String" id="9546">name</a>:<span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Any*" id="9547">args</a>:<span title="Any*">Any</span>*<span class="delimiter">)</span>:<a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a>
  <span class="keyword">def</span> <a title="[A](implicit evidence$1: Manifest[A])Option[A]" id="9549">typed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="9534">A</a> : Manifest<span class="delimiter">]</span>: <span title="Option[A]">Option</span><span class="delimiter">[</span>A<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="=&gt; List[dynamicJSON.DynamicJSON]" id="9535">array</a>:<span title="List[dynamicJSON.DynamicJSON]">List</span><span class="delimiter">[</span>DynamicJSON<span class="delimiter">]</span> = <span title="object Nil">Nil</span> 
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object dynamicJSON.DynamicJSON" id="9453">DynamicJSON</a><span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">import</span> scala.util.parsing.json.<span title="object scala.util.parsing.json.JSON">JSON</span>.parseFull
  
  <span class="keyword">def</span> <a title="(s: String)dynamicJSON.DynamicJSON" id="14394">apply</a><span class="delimiter">(</span><a title="String" id="16306">s</a>:<span title="String">String</span><span class="delimiter">)</span>:<a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a> = <span title="(input: String)Option[Any]">parseFull</span><span class="delimiter">(</span><a href="#16306" title="String">s</a><span class="delimiter">)</span> <span title="dynamicJSON.DynamicJSON" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="dynamicJSON.DynamicJSONObj">Some</span><span class="delimiter">(</span><a title="Map[String,Any]" id="16340">j</a>:<span title="Map[String,Any]">Map</span><span class="delimiter">[</span>String,Any<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span title="dynamicJSON.DynamicJSONObj" class="keyword">new</span> <a href="#24285" title="dynamicJSON.DynamicJSONObj">DynamicJSONObj</a><span class="delimiter">(</span><a href="#16340" title="Map[String,Any]">j</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="dynamicJSON.EmptyJSON.type">None</span> =&gt; <a href="#22092" title="object dynamicJSON.EmptyJSON">EmptyJSON</a>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="PartialFunction[Any,dynamicJSON.DynamicJSON]" id="14395">cast</a>:<span title="PartialFunction[Any,dynamicJSON.DynamicJSON]">PartialFunction</span><span class="delimiter">[</span>Any,DynamicJSON<span class="delimiter">]</span> = <a href="#16985" title="dynamicJSON.DynamicJSON" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="dynamicJSON.EmptyJSON.type" class="keyword">null</span> | <span title="object None">None</span> =&gt; <a href="#22092" title="object dynamicJSON.EmptyJSON">EmptyJSON</a>
<span class="comment">//  case i: Int     =&gt; ValueJSON(i) // Maybe , Scala standard JSON library not return Int or Long .</span>
<span class="comment">//  case l: Long    =&gt; ValueJSON(l)</span>
    <span class="keyword">case</span> <a title="dynamicJSON.ValueJSON[Double]" id="16986">d</a>: <span title="Double">Double</span>  =&gt; <a href="#24278" title="(value: Double)(implicit evidence$4: Manifest[Double])dynamicJSON.ValueJSON[Double]">ValueJSON</a><span title="=&gt; scala.reflect.AnyValManifest[Double]" class="delimiter">(</span><a href="#16986" title="Double">d</a><span class="delimiter">)</span>
<span class="comment">//    case d: JDouble =&gt; ValueJSON(d.doubleValue) //TODO is this need ?</span>
    <span class="keyword">case</span> <a title="dynamicJSON.ValueJSON[Boolean]" id="21131">b</a>: <span title="Boolean">Boolean</span> =&gt; <a href="#24278" title="(value: Boolean)(implicit evidence$4: Manifest[Boolean])dynamicJSON.ValueJSON[Boolean]">ValueJSON</a><span title="=&gt; scala.reflect.AnyValManifest[Boolean]" class="delimiter">(</span><a href="#21131" title="Boolean">b</a><span class="delimiter">)</span>
<span class="comment">//    case b: JBool   =&gt; ValueJSON(b.booleanValue)//TODO is this need ?</span>
    <span class="keyword">case</span> <a title="dynamicJSON.ValueJSON[String]" id="21139">s</a>: <span title="String">String</span>  =&gt; <a href="#24278" title="(value: String)(implicit evidence$4: Manifest[String])dynamicJSON.ValueJSON[String]">ValueJSON</a><span title="(clazz: Class[_])scala.reflect.Manifest[String]" class="delimiter">(</span><a href="#21139" title="String">s</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="dynamicJSON.DynamicJSON" id="21193">a</a>: <span title="List[_]">List</span><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.lang.Class[_]]" id="21195">classes</a> = <a href="#21193" title="List[_]">a</a>.<span title="(z: scala.collection.immutable.Set[java.lang.Class[_]])(f: (scala.collection.immutable.Set[java.lang.Class[_]], _) =&gt; scala.collection.immutable.Set[java.lang.Class[_]])scala.collection.immutable.Set[java.lang.Class[_]]">foldLeft</span><span class="delimiter">(</span><span title="[A](elems: A*)scala.collection.immutable.Set[A]">Set</span><span title="(elems: Class[_]*)scala.collection.immutable.Set[Class[_]]" class="delimiter">[</span><span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">{</span> <span class="delimiter">(</span><a title="scala.collection.immutable.Set[java.lang.Class[_]]" id="21605">set</a>,<a title="_" id="21606">elem</a><span class="delimiter">)</span> =&gt;
        <a href="#21605" title="scala.collection.immutable.Set[java.lang.Class[_]]">set</a> <span title="(elem: java.lang.Class[_])scala.collection.immutable.Set[java.lang.Class[_]]">+</span> <span class="delimiter">{</span>
          <span title="java.lang.Class[_1]" class="keyword">if</span><span class="delimiter">(</span><a href="#21606" title="_">elem</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> classOf<span title="java.lang.Class[Null](classOf[scala.Null])" class="delimiter">[</span>Null<span class="delimiter">]</span>
          <span class="keyword">else</span> <a href="#21606" title="_">elem</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>.<span title="()java.lang.Class[_]">getClass</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="dynamicJSON.DynamicJSON" class="keyword">if</span><span class="delimiter">(</span><a href="#21195" title="scala.collection.immutable.Set[java.lang.Class[_]]">classes</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">{</span>
        <a href="#21193" title="List[_]">a</a>.<span title="=&gt; _">head</span> <span title="dynamicJSON.DynamicJSON" class="keyword">match</span><span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="dynamicJSON.ValueJSON[List[Double]]">_</span>:<span title="Double">Double</span>  =&gt; <a href="#24278" title="(value: List[Double])(implicit evidence$4: Manifest[List[Double]])dynamicJSON.ValueJSON[List[Double]]">ValueJSON</a><span title="(clazz: Class[List[Double]], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[List[Double]]" class="delimiter">(</span><a href="#21193" title="List[_]">a</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[Double]" class="delimiter">[</span><span title="List[Double]">List</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">)</span>
<span class="comment">//        case _:JDouble =&gt; ValueJSON(a.asInstanceOf[List[Double]] )//TODO is this need ?</span>
          <span class="keyword">case</span> <span title="dynamicJSON.ValueJSON[List[Boolean]]">_</span>:<span title="Boolean">Boolean</span> =&gt; <a href="#24278" title="(value: List[Boolean])(implicit evidence$4: Manifest[List[Boolean]])dynamicJSON.ValueJSON[List[Boolean]]">ValueJSON</a><span title="(clazz: Class[List[Boolean]], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[List[Boolean]]" class="delimiter">(</span><a href="#21193" title="List[_]">a</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[Boolean]" class="delimiter">[</span><span title="List[Boolean]">List</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
<span class="comment">//        case _:JBool   =&gt; ValueJSON(a.asInstanceOf[List[Boolean]])//TODO is this need ?</span>
          <span class="keyword">case</span> <span title="dynamicJSON.ValueJSON[List[String]]">_</span>:<span title="String">String</span>  =&gt; <a href="#24278" title="(value: List[String])(implicit evidence$4: Manifest[List[String]])dynamicJSON.ValueJSON[List[String]]">ValueJSON</a><span title="(clazz: Class[List[String]], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[List[String]]" class="delimiter">(</span><a href="#21193" title="List[_]">a</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[String]" class="delimiter">[</span><span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="dynamicJSON.ValueJSON[List[Any]]">_</span>         =&gt; <a href="#24278" title="(value: List[Any])(implicit evidence$4: Manifest[List[Any]])dynamicJSON.ValueJSON[List[Any]]">ValueJSON</a><span title="(clazz: Class[List[Any]], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[List[Any]]" class="delimiter">(</span><a href="#21193" title="List[_]">a</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="List[Any]" class="delimiter">[</span><span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span><span class="keyword">else</span><span class="delimiter">{</span>
        <a href="#24278" title="[V](value: V)(implicit evidence$4: Manifest[V])dynamicJSON.ValueJSON[V]">ValueJSON</a><span title="(value: List[Any])(implicit evidence$4: Manifest[List[Any]])dynamicJSON.ValueJSON[List[Any]]" class="delimiter">[</span><span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span title="(clazz: Class[List[Any]], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[List[Any]]" class="delimiter">(</span><a href="#21193" title="List[_]">a</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">case</span> <a title="dynamicJSON.DynamicJSONObj" id="21825">map</a>:<span title="Map[String,Any]">Map</span><span class="delimiter">[</span>String,Any<span class="delimiter">]</span> =&gt; <span title="dynamicJSON.DynamicJSONObj" class="keyword">new</span> <a href="#24285" title="dynamicJSON.DynamicJSONObj">DynamicJSONObj</a><span class="delimiter">(</span><a href="#21825" title="Map[String,Any]">map</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
 
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class DynamicJSONObj extends java.lang.Object with dynamicJSON.DynamicJSON with ScalaObject with Product with Serializable" id="24285">DynamicJSONObj</a><a href="#24285" title="ScalaObject" class="delimiter">(</a><a title="Map[String,Any]" id="24282">obj</a>:<span title="Map[String,Any]">Map</span><span class="delimiter">[</span>String,Any<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[A](implicit evidence$2: Manifest[A])None.type" id="21828">typed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16954">A</a>: Manifest<span class="delimiter">]</span> = <span title="object None">None</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(name: String)(args: Any*)dynamicJSON.DynamicJSON" id="16955">applyDynamic</a><span class="delimiter">(</span><a title="String" id="21837">name</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Any*" id="21838">args</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span>: <a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a> = <a href="#9453" title="object dynamicJSON.DynamicJSON">DynamicJSON</a>.<a href="#14395" title="(v1: Any)dynamicJSON.DynamicJSON">cast</a><span class="delimiter">(</span><a href="#24282" title="(key: String)Any">obj</a><span class="delimiter">(</span><a href="#21837" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span> 
 
<span class="delimiter">}</span>

case <span class="keyword">object</span> <a href="#22087" title="object dynamicJSON.EmptyJSON" id="22092">EmptyJSON</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a><span class="delimiter">{</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(name: String)(args: Any*)dynamicJSON.DynamicJSON" id="16971">applyDynamic</a><span class="delimiter">(</span><a title="String" id="22070">name</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Any*" id="22071">args</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span>: <a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a> = <span class="keyword">this</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[A](implicit evidence$3: Manifest[A])None.type" id="22073">typed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="16974">A</a>: Manifest<span class="delimiter">]</span> = <span title="object None">None</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class ValueJSON[V] extends java.lang.Object with dynamicJSON.DynamicJSON with ScalaObject with Product with Serializable" id="24278">ValueJSON</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="17232">V</a> : Manifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="V" id="17251">value</a>: <a href="#17232" title="V">V</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a> <span class="delimiter">{</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(name: String)(args: Any*)dynamicJSON.DynamicJSON" id="17239">applyDynamic</a><span class="delimiter">(</span><a title="String" id="22098">name</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Any*" id="22099">args</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span>: <a href="#9452" title="dynamicJSON.DynamicJSON">DynamicJSON</a> = <a href="#22092" title="object dynamicJSON.EmptyJSON">EmptyJSON</a> 
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="[A](implicit evidence$5: Manifest[A])Option[A]" id="22101">typed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="17242">A</a>: Manifest<span class="delimiter">]</span> = 
    <span title="Option[A]" class="keyword">if</span><span class="delimiter">(</span><span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#17237" title="(implicit m: Manifest[V])Manifest[V]" class="delimiter">[</a><a href="#17232" title="V">V</a><span class="delimiter">]</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#22101" title="(implicit m: Manifest[A])Manifest[A]" class="delimiter">[</a><a href="#17242" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span>
      <span title="(x: A)Some[A]">Some</span><span class="delimiter">(</span><a href="#17251" title="=&gt; V">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#17242" title="A">A</a><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="keyword">else</span>
      <span title="object None">None</span>

  <span class="comment">// debug method</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="17243">manifestString</a>:<span title="String">String</span> = <span title="[T](implicit m: Manifest[T])Manifest[T]">manifest</span><a href="#17237" title="(implicit m: Manifest[V])Manifest[V]" class="delimiter">[</a><a href="#17232" title="V">V</a><span class="delimiter">]</span>.<span title="()java.lang.String">toString</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[dynamicJSON.DynamicJSON]" id="17244">array</a> = <a href="#17251" title="=&gt; V">value</a> <span title="List[dynamicJSON.DynamicJSON]" class="keyword">match</span><span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="List[dynamicJSON.DynamicJSON]" id="22129">l</a>: <span title="List[_]">List</span><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <a href="#22129" title="List[_]">l</a>.<span title="(f: _ =&gt; dynamicJSON.DynamicJSON)(implicit bf: scala.collection.generic.CanBuildFrom[List[_],dynamicJSON.DynamicJSON,List[dynamicJSON.DynamicJSON]])List[dynamicJSON.DynamicJSON]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,dynamicJSON.DynamicJSON,List[dynamicJSON.DynamicJSON]]" class="delimiter">{</span><a href="#9453" title="object dynamicJSON.DynamicJSON">DynamicJSON</a>.<a href="#14395" title="=&gt; PartialFunction[Any,dynamicJSON.DynamicJSON]">cast</a><span class="delimiter">}</span>
    <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">_</span>          =&gt; <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>